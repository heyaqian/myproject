<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="pub/pub.css">
    <link rel="stylesheet" href="css/public.css"> 
</head>
<body>
  <!-- <div class="lc"> -->
    <ul class="lc">
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
    </ul>
    <div class="backT">置顶</div>
  <!-- </div> -->
    <div class="top">
        <header>
            <div class="margin clear">
                <div class="top-l">
                    <p>                
                        <span class="log"><a href="login.html">登录</a></span>
                        <span class="reg"><a href="register.html">注册</a></span>
                    </p>
                </div>
                <div class="top-r">
                    <ul>
                        <li class="li1">我的订单</li>
                        <li class="li2">新手指南</li>
                        <li class="li3"><i></i>收藏本站</li>
                        <li class="li4"><i></i>微信扫一扫<div><img src="images/ma.png"></div></li>                 
                    </ul>
                </div>
        </header>
        <nav>
            <div class="margin clear nav">            
                <a class="logo"><img src="images/logo.png"></a>
                <p class="streg">
                    <span>热门周边</span>
                    <span>最热漫画</span>
                    <span>优秀小说</span>                        
                </p>
                <div class="xlkuang">
                   
                </div>
                <div class="search">
                    <form>
                        <input type="text" placeholder="请输入关键字搜索" class="txt" value=""/>
                       <input type="button" name="" id="search" class="sub">
                    </form>
                </div>                   
            </div>
        </nav>
    </div>
    <script src="libs/jquery.js"></script>
    <script type="text/javascript">
        // setInterval(()=>{
          $(function(){
            // $(".top").load("http://localhost:81/pub/pub.html .top" )

            $(".footer").load("http://localhost:81/pub/pub.html .footer" );
        })
        // });
    </script>
    <section>
        <div class="margin clear banner box">
            <div class="menu">
                <ul>
                    <li><span>小说</span><i></i><div></div></li>
                    <li><span>杂志</span><i></i><div></div></li>
                    <li><span>绘本</span><i></i><div></div></li>
                    <li><span>周边</span><i></i><div></div></li>
                    <li><span>漫画</span><i></i><div></div></li>
                </ul>
            </div>            
            <div class="imgbox">
                <img src="images/O1CN01bIOc8E2AzzwRNk6TO_!!1739428275.jpg">
                <img src="images/O1CN01q3qwpr297D0KN8zTa_!!3032658020.jpg">
                <img src="images/O1CN01RR5Gb2297D06qPHDf_!!3032658020.jpg">
                <img src="images/TB2N5ZfdmfD8KJjSszhXXbIJFXa_!!3032658020.jpg">               
            </div>
            <div class="btns">
                <input type="button" value="" id="left"/>
                <input type="button" value="" id="right"/>
            </div>
        </div>                   
    </section>
    <div class="banner-b">
            <div class="margin clear .bt">
        <div class="fl">
            <ul>
                <li> <div></div> </li>
                <li> <div></div> </li>
                <li> <div></div> </li>
                <li> <div></div> </li>
                <li> <div></div> </li>
                <li> <div></div> </li>               
            </ul>
        </div>
        <div class="fr">           

        </div>
    </div>
    <div id="daily">
        <div class="margin clear daily">
           <p><img src="images/everyday.png" alt=""></p>
           <div class="lr">
               <img src="images/new_prev.png" alt="">
               <img src="images/new_next.png" alt="">
           </div>
        </div>
    </div>
        <div id="daily-b">
            <div class="margin clear daily-b">
              
            </div>
        </div>
        <main>
            <div class="margin clear main">
                <div class="main-novel">
                    <p><img src="images/novel.png" alt=""></p>
                    <div class="lr">
                        <img src="images/more_yellow.png" class="more" alt="">
                        <img src="images/new_next.png" alt="">
                    </div>
                </div>
                <div class="main-novel-p">
                    <div class="novel-p-l">
                        <img src="images/1543304615099092093.jpg" alt="">
                    </div>
                    <div class="novel-p-r">
                        <div class="novel-r-t">
    
                        </div>
                        <div class="novel-r-b">
                          
                        </div>             
                        </div>
                    </div>
                </div>
                <div class="main-magazine   margin">
                        <p><img src="images/magazine.png" alt=""></p>
                        <div class="lr">
                         
                        </div>
                </div>
                    <div class="main-magazine-p   margin">
                        <div class="novel-p-l">
                            <img src="images/1550564293201665977.jpg" alt="">
                            <img src="images/1543476139490530174.jpg" class="img-b" alt="">
                        </div>
                        <div class="novel-p-r">
                            <div class="novel-r-t">
                          
                            </div>
                            <div class="novel-r-b">
                              
                            </div>             
                        </div>
                    </div>
                </div>
            </div>           
        </main>
    <footer class="footer">
      
    </footer>
 
</body>
 <script src="libs/jquery.js"></script>
<script src="js/ajax.js"></script>
<script src="js/jquery.banner.js"></script>
<script src="js/cookie.js"></script>
<script> 
    class list{
    constructor(){
        this.fr=document.querySelector(".fr");      
        this.daily=document.querySelector(".daily-b");
        this.story=document.querySelector(".daily-b");
        this.novelrt=document.querySelector(".novel-r-t");
        this.novelrb=document.querySelector(".novel-r-b");
        this.magazinet=document.querySelector(".main-magazine-p .novel-p-r .novel-r-t");
        this.magazineb=document.querySelector(".main-magazine-p .novel-p-r .novel-r-b");
        // console.log(this.cont);   
        this.search=document.querySelector("#search");
        this.ipt=document.querySelector(".txt");
        // console.log(this.search);
        this.url="http://localhost:81/data/nav.json";           
        this.urld="http://localhost:81/data/daily.json";           
        this.urls="http://localhost:81/data/story.json";
        this.urlm="http://localhost:81/data/magezine.json";       
        this.load();
        this.loadd();
        this.loads();
        this.loadm();       
    }
    addEvent(){
        var that=this;
        console.log(this.res1);
        
        this.search.onclick=function(){ 
            that.value=that.ipt.value;
            // console.log(that.ipt.value);
            that.goods=[];
            for(var i=0;i<that.res1.length;i++){
            // console.log(that.res[i].name);
                if(that.res1[i].name.includes(that.value)){
                    // console.log(that.res[i].id);                   
                    // that.id=that.res[i].id;                   
                    that.goods.push(
                        that.res1[i].id 
                    );                 
                    // console.log(that.goods);                     
                    setCookie("goodsDECookie",JSON.stringify(that.goods));
                    location.href="list.html";
                }
            }     
         }
    }
    load(){
        var that=this;
        ajaxGet(this.url,function(res){
            // console.log(JSON.parse(res));
            that.res=JSON.parse(res);
            that.display();
        })
    }
    loadd(){
        var that=this;
        
        ajaxGet(this.urld,function(res){          
            that.res=JSON.parse(res);
            that.displayd( that.xlkuang);
        })
    }
    loads(){
        var that=this;
        ajaxGet(this.urls,function(res1){
            that.res1=JSON.parse(res1);
            console.log(that.res1); 
            that.displays();
            that.addEvent()
        })
    }
    loadm(){
        var that=this;
        ajaxGet(this.urlm,function(res){
            console.log(JSON.parse(res));
            that.res=JSON.parse(res);
            that.displaym();
        })
    }
     display(){
        //查看数      
        var str="";      
        for(var i=0;i<this.res.length;i++){
            // goodsId点击按钮定位商品         
                str+=`<a href="" target="_blank"><img src="${this.res[i].url}" width="317" height="171" ></a>`;                                
        }
        // 将数据插入页面中cont,innerHTML可以渲染页面
        this.fr.innerHTML=str;
    }
     displaym(){
        //查看数      
        var str="";  
        var str2="";    
        for(var i=0;i<4;i++){
            // goodsId点击按钮定位商品         
                str+=`<div class="box">
                        <img src="${this.res[i].url}" alt="">
                        <p class="name">${this.res[i].name}</p>
                        <p class="price">${this.res[i].price}</p>
                    </div>`;                                
        }
        for(var i=4;i<this.res.length-1;i++){
            str2+=`<div class="box">
                <img src="${this.res[i].url}" alt="">
                <p class="name">${this.res[i].name}</p>
                <p class="price">${this.res[i].price}</p>
            </div>`;           
        }
        for(var i=this.res.length-1;i<this.res.length;i++){
            str2+=`<div class="box-last">
                    <div class="t">
                        <div class="l">
                            <p class="name-l">${this.res[i].name}</p>
                            <p class="price-l">${this.res[i].price}</p>
                        </div>
                        <div class="r"><img src="${this.res[i].url}" alt=""></div>
                    </div>
                    <div class="b">
                        <img src="images/more_white.png" alt="" class="more">
                        <img src="images/back.png" alt="" class="back">
                    </div>`
        }
        // 将数据插入页面中cont,innerHTML可以渲染页面
        this.magazinet.innerHTML=str;
        this.magazineb.innerHTML=str2;
    }
     displayd(){
        //查看数据
        console.log(this.res);
        console.log(this.res[1].url);       
        var str="";
       
        for(var i=0;i<this.res.length;i++){
            // goodsId点击按钮定位商品
        str+=`<div>
                    <img src="${this.res[i].url}" alt="">
                    <p class="name">${this.res[i].name}</p>
                    <p class="price">${this.res[i].price}</p>
                </div>`;           
        }
       
        // 将数据插入页面中cont,innerHTML可以渲染页面
        this.daily.innerHTML=str;
        this.xlkuang=document.querySelector(".xlkuang");
        //在这里获取不会有回调函数的问题，ajax获取值得问题，异步
        // console.log(this.xlkuang,5555);
        this.xlkuang.innerHTML=str;       
    }
     displays(){
        //查看数据
        console.log(this.res1);
        console.log(this.res1[1].url);       
        var str="";
        var str2="";
        for(var i=0;i<4;i++){
            // goodsId点击按钮定位商品
        str+=`<div class="box">
                <img src="${this.res1[i].url}" alt="">
                <p class="name">${this.res1[i].name}</p>
                <p class="price">${this.res1[i].price}</p>
            </div>             `;           
        }
        for(var i=4;i<this.res1.length-1;i++){
            str2+=`<div class="box">
                <img src="${this.res1[i].url}" alt="">
                <p class="name">${this.res1[i].name}</p>
                <p class="price">${this.res1[i].price}</p>
            </div>`;           
        }
        for(var i=this.res1.length-1;i<this.res1.length;i++){
            str2+=`<div class="box-last">
                    <div class="t">
                        <div class="l">
                            <p class="name-l">${this.res1[i].name}</p>
                            <p class="price-l">${this.res1[i].price}</p>
                        </div>
                        <div class="r"><img src="${this.res1[i].url}" alt=""></div>
                    </div>
                    <div class="b">
                        <img src="images/more_white.png" alt="" class="more">
                        <img src="images/back.png" alt="" class="back">
                    </div>`
        }
        // 将数据插入页面中cont,innerHTML可以渲染页面
        this.novelrt.innerHTML=str;
        this.novelrb.innerHTML=str2;
    }

}
//window.onload=function(){
    new list;
// }
    

    $(".menu").find("li").mouseover(function(){
        // console.log($(".menu"));     
			$(this)
			.children("div")
			.stop()
            .show(300)
			.parent()
			.siblings()
			.children("div")
			.stop()
            .hide(300)
		}).mouseleave(function(){       
            $(this)
			.children("div")
			.stop()
            .hide(300)
        })

        $(".lc li").click(function(){
			var i = $(this).index();
			$("html").animate({
				scrollTop:$(window).height()*(i+1)
			})
		})

        $(".backT").click(function(){
            var ch=$(document.body).height()
            // console.log(1);          
			$("html").animate({
				scrollTop:-document.body.clientHeight
				// scrollTop:
			})
		})

	$(".banner").banner({
			items:$(".banner").find("img"),
			left:$(".banner").find("#left"),
			right:$(".banner").find("#right"),
			list:true,
			index:1,
			autoPlay:true,
			delayTime:3000,
			moveTime:3000
        })
        $(".box").on("mouseenter", function() {
            $("#left").css({
                left:120,
                width:0,
            }).stop().animate({
                left:120,
                width:30,
            }).siblings("#right").css({
               right:0,
               width:0
            }).stop().animate({
                right:0,
                width:30
            }) 
       }).on("mouseleave",function(){
                $("#left").css({
                left:120,
                width:30,
            }).stop().animate({
                left:120,
                width:0,
            },1000).siblings("#right").css({
               right:0,
               width:30
            }).stop().animate({
                right:0,
                width:0
            })
         })   
    
    
    // this.search.onclick=function(){       
        // console.log(this.ipt.value);       
        // location.href="list.html";
        // setCookie("searchval",JSON.stringify())
    // }

// window.onload=function(){
//     // console.log( $("#search").length);
//     console.log( $("#search"));
//     // $("#search").css('color','red');
//     $("#search").click(function(){
//         console.log(1);
//         // $(location).attr("href","list.html");
//         window.location.href = "list.html";
//         // window.location.reload(); 
//     });   
// }   //这一行只能跳转一次
 
    window.onload=function(){
        console.log($(".streg")); 
        $(".streg").mouseenter(function(){
            // console.log(1);   
            $(".xlkuang").css({
                top:120,
                height:0,
            }).stop().animate({
                top:120,
                height:240,
            }).mouseleave(function(){
                $(".xlkuang").css({
                top:120,
                height:240,
            }).stop().animate({
                top:120,
                height:0,
            })
         })
    });   
}

</script>
</html>